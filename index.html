<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="HAS Sothea, PhD">
<meta name="dcterms.date" content="2024-10-30">

<title>Exploratory Data Analysis &amp; Unsupervised Learning  </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<link rel="stylesheet" href="style.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><strong>Exploratory Data Analysis &amp; Unsupervised Learning</strong> <img src="./img/AMS_logo.png#right" class="img-fluid" style="width:0.625in"> <img src="./img/itc.png#left" class="img-fluid" style="position: relative; bottom: 5px;width:0.41667in"></h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p><a href="https://hassothea.github.io/">HAS Sothea, PhD</a> </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">October 30, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#course-criteria" id="toc-course-criteria" class="nav-link" data-scroll-target="#course-criteria">Course Criteria</a>
  <ul class="collapse">
  <li><a href="#programming" id="toc-programming" class="nav-link" data-scroll-target="#programming">Programming:</a></li>
  </ul></li>
  <li><a href="#tp-sections" id="toc-tp-sections" class="nav-link" data-scroll-target="#tp-sections">TP Sections</a></li>
  <li><a href="#midterms-exams-and-projects" id="toc-midterms-exams-and-projects" class="nav-link" data-scroll-target="#midterms-exams-and-projects">Midterms, Exams and Projects</a>
  <ul class="collapse">
  <li><a href="#project" id="toc-project" class="nav-link" data-scroll-target="#project">‚úèÔ∏è Project:</a></li>
  </ul></li>
  <li><a href="#resources-and-further-reading" id="toc-resources-and-further-reading" class="nav-link" data-scroll-target="#resources-and-further-reading">Resources and Further Reading</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome to the practical session webpage on <strong>Exploratory Data Analysis (EDA) and Unsupervised Learning</strong>! This session is designed to equip you with the essential skills and techniques to explore and understand your data before diving into more complex modeling tasks. By the end of this session, you will be adept at uncovering crucial insights hidden within the data and leveraging this knowledge to guide your analysis effectively. You will approach data analysis with a clear objective, applying a variety of techniques to understand, interpret, and make informed decisions based on the data. Additionally, you will be able to present your findings visually, making them accessible for both technical and general audiences.</p>
<hr>
</section>
<section id="course-criteria" class="level1">
<h1>Course Criteria</h1>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"><strong><code>Criteria</code></strong></th>
<th style="text-align: center;"><strong><code>Percentage</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attendance</td>
<td style="text-align: center;">10%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Participation &amp; quiz</td>
<td style="text-align: center;">10%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Midterm Exam or/and Project</td>
<td style="text-align: center;">15%+15%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Final Exam</td>
<td style="text-align: center;">20%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Final Project &amp; Presentation</td>
<td style="text-align: center;">30%</td>
</tr>
</tbody>
</table>
<section id="programming" class="level2">
<h2 class="anchored" data-anchor-id="programming">Programming:</h2>
<blockquote class="blockquote">
<p>You are free you use your favorite programming language <a href="https://www.python.org/" target="_blank"><img src="./img/python.png" class="img-fluid" style="position: relative; bottom: 0px" width="30"></a> <code>Python</code> or <a href="https://www.r-project.org/" target="_blank"><img src="./img/R_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="30"></a>‚Ä¶</p>
</blockquote>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href=""><code>Python</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href=""><code>R</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><a href="https://docs.jupyter.org/en/latest/" target="_blank"><img src="./img/jupyter.png" class="img-fluid" style="position: relative; bottom: 0px" width="30"> Jupyter Notebook</a></li>
<li><a href="https://colab.research.google.com/" target="_blank"><img src="./img/colab.png" class="img-fluid" style="position: relative; bottom: 0px" width="30"> Google colab</a></li>
<li><a href="https://matplotlib.org/" target="_blank"><img src="./img/plt_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="35"> Matplotlib</a></li>
<li><a href="https://seaborn.pydata.org/" target="_blank"><img src="./img/sns_logo.svg" class="img-fluid" style="position: relative; bottom: 0px" width="30"> Seaborn</a></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li><a href="https://quarto.org/" target="_blank"><img src="./img/quarto_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="60"> Rmarkdown/Quarto</a></li>
<li><a href="https://ggplot2.tidyverse.org/" target="_blank"><img src="./img/posit_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="25"> Posit cloud</a></li>
<li><a href="https://ggplot2.tidyverse.org/" target="_blank"><img src="./img/ggplot_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="27"> Ggplot2</a></li>
<li><a href="https://www.tidyverse.org/" target="_blank"><img src="./img/tidyverse_logo.png" class="img-fluid" style="position: relative; bottom: 0px" width="30"> Tidyverse</a></li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="tp-sections" class="level1">
<h1>TP Sections</h1>
<div class="line-block"><strong>Note</strong>: The following table of contents will be progressively updated according to the course advancement.</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Topic</th>
<th style="text-align: center;">TP</th>
<th style="text-align: center;">Solution</th>
<th style="text-align: center;">Remark</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Univariate Analysis</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP1_Variable_Types_Descriptive_Statistics.html" target="_blank">TP1-Gapminder</a></td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/Solutions/TP1_Variable_Types_Descriptive_Statistics_sol.html" target="_blank">TP1-solution</a></td>
<td style="text-align: center;">‚úÖ Completed</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bivariate Analysis</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP2_Bivariate_Analysis.html" target="_blank">TP2-Bivariate-Gapminder</a></td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/Solutions/TP2_Bivariate_Analysis_sol.html" target="_blank">TP2-solution</a></td>
<td style="text-align: center;">‚úÖ Completed</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Data Preprocessing</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP3_Data_Preprocessing.html" target="_blank">TP3-Preprocessing</a></td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/Solutions/TP3_Data_Preprocessing_sol.html" target="_blank">TP3-solution</a></td>
<td style="text-align: center;">‚úÖ Completed</td>
</tr>
<tr class="even">
<td style="text-align: left;">Clustering</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP4_Clustering.html" target="_blank">TP4-Clustering</a></td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/Solutions/TP4_Clustering_sol.html" target="_blank">TP4-solution</a></td>
<td style="text-align: center;">‚úÖ Completed</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gaussian Mixture Models & EM Algorithm</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP5_GMM_EM.html" target="_blank">TP5-GMM_EM</a></td>
<td style="text-align: center;">TP5-Solution</td>  <!-- <a href="https://hassothea.github.io/EDA_ITC/Solutions/TP5_GMM_EM_sol.html" target="_blank">TP5-solution</a> -->
<td style="text-align: center;"><code>...Loading</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Principal Component Analysis (PCA)</td>
<td style="text-align: center;"><a href="https://hassothea.github.io/EDA_ITC/TPs/TP6_PCA.html" target="_blank">TP6-PCA</a></td>
<td style="text-align: center;">TP6-Solution</td>  <!-- <a href="https://hassothea.github.io/EDA_ITC/Solutions/TP5_GMM_EM_sol.html" target="_blank">TP5-solution</a> -->
<td style="text-align: center;"><code>...Loading</code></td>
</tr>
</tbody>
</table>
<!--](https://hassothea.github.io/EDA_ITC/TPs/TP3_Data_Preprocessing.html){target="_blank"} | [TP3-solution](https://hassothea.github.io/EDA_ITC/Solutions/TP3_Data_Preprocessing_sol.html){target="_blank"} | ‚úÖ Completed | -->
</section>
<section id="midterms-exams-and-projects" class="level1">
<h1>Midterms, Exams and Projects</h1>
<p>In this section, you will find all the information related to the midterms, exams and projects including instructions, starting dates and the deadlines.</p>
<section id="project" class="level2">
<h2 class="anchored" data-anchor-id="project">‚úèÔ∏è Project:</h2>
<ul>
<li>Deadline for the report: <code>...Loading</code>.</li>
<li>Where to submit: <code>...Loading</code></li>
<li>Your report should be in (your favorite) <strong>PDF</strong> format and include the following criteria:
<ul>
<li><strong>Members‚Äô names &amp; contributions</strong>.
<ul>
<li>Clearly state each member‚Äôs contribution to the report.</li>
<li>For example:
<ul>
<li><strong>Luffy</strong>: Introduction, Data Preprocessing</li>
<li><strong>Gojo</strong>: Exploratory Data Analysis, Model Development</li>
<li><strong>Naruto</strong>: Results and Evaluation, Conclusion</li>
</ul></li>
</ul></li>
<li><strong>Introduction</strong>:
<ul>
<li>Clearly state the objectives and purpose of the analysis.</li>
<li>Provide a brief descriptive statistics of the dataset.</li>
</ul></li>
<li><strong>Data Preprocessing</strong>:
<ul>
<li>Detail steps taken to clean and preprocess the data.</li>
<li>Explain handling of missing values and outliers.</li>
<li>Describe any feature engineering techniques applied.</li>
</ul></li>
<li><strong>Exploratory Data Analysis (EDA)</strong>:
<ul>
<li>Include visualizations (charts, graphs) and descriptive statistics.</li>
<li>Identify key patterns, trends, and anomalies in the data.</li>
</ul></li>
<li><strong>Unsupervised/supervised Tasks</strong>:
<ul>
<li>Exploring structures or connections of the data according the flow of your analysis.</li>
<li>Provide details on clustering methods or model training, validation, and testing processes.</li>
<li>Include any choice of parameters of unsupervised tasks or hyperparameter tuning and model optimizations.</li>
</ul></li>
<li><strong>Results and Evaluation</strong>:
<ul>
<li>Present the resulting performance (e.g., obtained structures or accuracy, precision, recall, F1-score, RMSE).</li>
<li>Compare performance across different methods if multiple were used.</li>
<li>Highlight any insights or conclusions drawn from the implemented methods/models.</li>
</ul></li>
<li><strong>Conclusion</strong>:
<ul>
<li>Summarize key findings and their implications.</li>
<li>Discuss any limitations of the analysis.</li>
<li>Suggest potential areas for future research or improvement.</li>
</ul></li>
<li><strong>References</strong>:
<ul>
<li>Cite all sources of data and any external libraries or tools used.</li>
<li>Include academic references for any theoretical concepts or methods applied.</li>
</ul></li>
<li><strong>Appendix (Optional)</strong>:
<ul>
<li>Provide additional figures, tables, or code snippets that support the analysis.</li>
</ul></li>
</ul></li>
<li><strong>Presentation</strong>:
<ul>
<li>A possible dates: <code>...Loading</code>.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="resources-and-further-reading" class="level1">
<h1>Resources and Further Reading</h1>
<p>Here, you will find additional resources, including books, research papers, and online courses, to further your understanding of <strong>Exploratory Data Analysis and Unsupervised Learning</strong>.</p>
<p>üìö You will find these books/links helpful‚Ä¶</p>
<ul>
<li><p><a href="https://github.com/PacktPublishing/Exploratory-Data-Analysis-with-Python-Cookbook?tab=readme-ov-file" target="_blank">Exploratory-Data-Analysis-with-Python-Cookbook</a></p></li>
<li><p><a href="https://haralick.org/DV/Handbook_of_Data_Visualization.pdf" target="_blank">Handbook of Data Visualization, Chen et al.</a></p></li>
<li><p><a href="https://wesmckinney.com/book/" target="_blank">Python for Data Analysis, Wes M.</a></p></li>
<li><p><a href="https://bookdown.org/rdpeng/exdata/" target="_blank">Exploratory Data Analysis with R, Roger D. Peng</a></p></li>
<li><p><a href="https://batrachos.com/sites/default/files/pictures/Books/Wickham_Grolemund_2017_R%20for%20Data%20Science.pdf" target="_blank">R for Data Science, Hadley W. and Garrett G.</a></p></li>
</ul>
<hr>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hassothea\.github\.io\/MLcourses\/index\.html");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
